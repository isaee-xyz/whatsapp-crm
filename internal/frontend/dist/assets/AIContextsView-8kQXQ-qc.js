import{d as J,r as v,x as j,Q as C,c as g,h as a,a as s,w as l,g as R,b as t,i,v as p,l as I,I as V,J as E,S as K,k as x,F as N,s as F,n as q,K as m,o as d}from"./index-CYNh7eqI.js";import{a as L,_ as D}from"./CardContent.vue_vue_type_script_setup_true_lang-BVSlREZs.js";import{_ as H,a as Q}from"./CardTitle.vue_vue_type_script_setup_true_lang-C5-EVre-.js";import{_ as W}from"./CardDescription.vue_vue_type_script_setup_true_lang-CRilvynw.js";import{_ as f}from"./Button.vue_vue_type_script_setup_true_lang-CdpToHaS.js";import{_ as y}from"./Input.vue_vue_type_script_setup_true_lang-c8YZDCZO.js";import{_ as u}from"./Label.vue_vue_type_script_setup_true_lang-BiSM-I6O.js";import{_ as O}from"./Textarea.vue_vue_type_script_setup_true_lang-qPA_yzOk.js";import{_ as $}from"./Badge.vue_vue_type_script_setup_true_lang-lXziiQoX.js";import{_ as X}from"./ScrollArea.vue_vue_type_script_setup_true_lang-BYu-HJVo.js";import{_ as Y,a as Z,b as ee,c as te,d as ae,e as se}from"./DialogFooter.vue_vue_type_script_setup_true_lang-BYVwNXX_.js";import{_ as oe}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-CvBIzWt_.js";import{A as le}from"./arrow-left-DE60ug_1.js";import{P as G,a as re,T as ne}from"./trash-2-ExN6Amm1.js";import{a as ie}from"./createLucideIcon-CJWRy_ZI.js";import{F as de}from"./file-text-BmYyHgjR.js";import{S as ue}from"./sparkles-B97ihEtN.js";/**
 * @license lucide-vue-next v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=ie("GlobeIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),me={class:"flex flex-col h-full"},fe={class:"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"},_e={class:"flex h-16 items-center justify-between px-6"},ce={class:"flex items-center gap-4"},ve={class:"grid gap-4 py-4 max-h-[60vh] overflow-y-auto"},ge={class:"grid grid-cols-2 gap-4"},xe={class:"space-y-2"},ye={class:"space-y-2"},be={class:"space-y-2"},we={class:"space-y-2"},he={key:0,class:"space-y-4 border-t pt-4"},ke={class:"grid grid-cols-4 gap-4"},Ce={class:"col-span-1 space-y-2"},Ae={class:"col-span-3 space-y-2"},Ie={class:"text-xs text-muted-foreground"},Ve={class:"bg-muted px-1 rounded"},$e={class:"bg-muted px-1 rounded"},Pe={class:"space-y-2"},Se={class:"space-y-2"},Te={class:"grid grid-cols-2 gap-4"},Ue={class:"space-y-2"},Ee={class:"flex items-center gap-2 pt-8"},Ne={class:"p-6 grid gap-4 md:grid-cols-2"},Fe={class:"flex items-start justify-between"},Le={class:"flex items-center gap-3"},De={key:0,class:"flex flex-wrap gap-1 mb-3"},Oe={class:"flex flex-wrap gap-2 mb-3"},Ge={class:"flex items-center justify-between"},Me={class:"flex gap-2"},lt=J({__name:"AIContextsView",setup(ze){const b=v([]),P=v(!0),_=v(!1),w=v(!1),c=v(null),o=v({name:"",context_type:"static",trigger_keywords:"",static_content:"",api_url:"",api_method:"GET",api_headers:"",api_response_path:"",priority:10,enabled:!0}),S=n=>`{{${n}}}`;j(async()=>{await A()});async function A(){P.value=!0;try{const n=await C.listAIContexts(),e=n.data.data||n.data;b.value=e.contexts||[]}catch(n){console.error("Failed to load AI contexts:",n),b.value=[]}finally{P.value=!1}}function T(){c.value=null,o.value={name:"",context_type:"static",trigger_keywords:"",static_content:"",api_url:"",api_method:"GET",api_headers:"",api_response_path:"",priority:10,enabled:!0},_.value=!0}function M(n){c.value=n;const e=n.api_config||{};o.value={name:n.name,context_type:n.context_type||"static",trigger_keywords:(n.trigger_keywords||[]).join(", "),static_content:n.static_content||"",api_url:e.url||"",api_method:e.method||"GET",api_headers:e.headers?JSON.stringify(e.headers,null,2):"",api_response_path:e.response_path||"",priority:n.priority||10,enabled:n.enabled},_.value=!0}async function z(){if(!o.value.name.trim()){m.error("Please enter a name");return}if(o.value.context_type==="api"&&!o.value.api_url.trim()){m.error("Please enter an API URL");return}w.value=!0;try{let n={};if(o.value.api_headers.trim())try{n=JSON.parse(o.value.api_headers)}catch{m.error("Invalid JSON format for headers"),w.value=!1;return}const e={name:o.value.name,context_type:o.value.context_type,trigger_keywords:o.value.trigger_keywords.split(",").map(h=>h.trim()).filter(Boolean),static_content:o.value.static_content,api_config:o.value.context_type==="api"?{url:o.value.api_url,method:o.value.api_method,headers:n,response_path:o.value.api_response_path}:null,priority:o.value.priority,enabled:o.value.enabled};c.value?(await C.updateAIContext(c.value.id,e),m.success("AI context updated")):(await C.createAIContext(e),m.success("AI context created")),_.value=!1,await A()}catch{m.error("Failed to save AI context")}finally{w.value=!1}}async function B(n){if(confirm(`Are you sure you want to delete "${n.name}"?`))try{await C.deleteAIContext(n.id),m.success("AI context deleted"),await A()}catch{m.error("Failed to delete AI context")}}return(n,e)=>{const h=R("RouterLink");return d(),g("div",me,[a("header",fe,[a("div",_e,[a("div",ce,[s(h,{to:"/chatbot"},{default:l(()=>[s(t(f),{variant:"ghost",size:"icon"},{default:l(()=>[s(t(le),{class:"h-5 w-5"})]),_:1})]),_:1}),e[12]||(e[12]=a("div",null,[a("h1",{class:"text-xl font-semibold"},"AI Contexts"),a("p",{class:"text-sm text-muted-foreground"},"Knowledge bases for AI-powered responses")],-1))]),s(t(Y),{open:_.value,"onUpdate:open":e[11]||(e[11]=r=>_.value=r)},{default:l(()=>[s(t(oe),{"as-child":""},{default:l(()=>[s(t(f),{onClick:T},{default:l(()=>[s(t(G),{class:"h-4 w-4 mr-2"}),e[13]||(e[13]=i(" Add Context ",-1))]),_:1})]),_:1}),s(t(Z),{class:"max-w-2xl"},{default:l(()=>[s(t(ee),null,{default:l(()=>[s(t(te),null,{default:l(()=>[i(p(c.value?"Edit":"Create")+" AI Context",1)]),_:1}),s(t(ae),null,{default:l(()=>[...e[14]||(e[14]=[i(" Add knowledge context that the AI can use when responding to messages. ",-1)])]),_:1})]),_:1}),a("div",ve,[a("div",ge,[a("div",xe,[s(t(u),{for:"name"},{default:l(()=>[...e[15]||(e[15]=[i("Name *",-1)])]),_:1}),s(t(y),{id:"name",modelValue:o.value.name,"onUpdate:modelValue":e[0]||(e[0]=r=>o.value.name=r),placeholder:"Product FAQ"},null,8,["modelValue"])]),a("div",ye,[s(t(u),{for:"context_type"},{default:l(()=>[...e[16]||(e[16]=[i("Type",-1)])]),_:1}),V(a("select",{id:"context_type","onUpdate:modelValue":e[1]||(e[1]=r=>o.value.context_type=r),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},[...e[17]||(e[17]=[a("option",{value:"static"},"Static Content",-1),a("option",{value:"api"},"API Fetch",-1)])],512),[[E,o.value.context_type]])])]),a("div",be,[s(t(u),{for:"trigger_keywords"},{default:l(()=>[...e[18]||(e[18]=[i("Trigger Keywords (comma-separated, optional)",-1)])]),_:1}),s(t(y),{id:"trigger_keywords",modelValue:o.value.trigger_keywords,"onUpdate:modelValue":e[2]||(e[2]=r=>o.value.trigger_keywords=r),placeholder:"faq, help, info"},null,8,["modelValue"]),e[19]||(e[19]=a("p",{class:"text-xs text-muted-foreground"}," Leave empty to always include this context, or specify keywords to include only when mentioned. ",-1))]),a("div",we,[s(t(u),{for:"static_content"},{default:l(()=>[...e[20]||(e[20]=[i("Content / Prompt",-1)])]),_:1}),s(t(O),{id:"static_content",modelValue:o.value.static_content,"onUpdate:modelValue":e[3]||(e[3]=r=>o.value.static_content=r),placeholder:"Enter knowledge content or prompt for the AI...",rows:6},null,8,["modelValue"]),e[21]||(e[21]=a("p",{class:"text-xs text-muted-foreground"}," This content will be provided to the AI as context for generating responses. ",-1))]),o.value.context_type==="api"?(d(),g("div",he,[e[30]||(e[30]=a("p",{class:"text-sm font-medium"},"API Configuration",-1)),e[31]||(e[31]=a("p",{class:"text-xs text-muted-foreground"}," Data fetched from this API will be combined with the content above. ",-1)),a("div",ke,[a("div",Ce,[s(t(u),{for:"api_method"},{default:l(()=>[...e[22]||(e[22]=[i("Method",-1)])]),_:1}),V(a("select",{id:"api_method","onUpdate:modelValue":e[4]||(e[4]=r=>o.value.api_method=r),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},[...e[23]||(e[23]=[a("option",{value:"GET"},"GET",-1),a("option",{value:"POST"},"POST",-1)])],512),[[E,o.value.api_method]])]),a("div",Ae,[s(t(u),{for:"api_url"},{default:l(()=>[...e[24]||(e[24]=[i("API URL *",-1)])]),_:1}),s(t(y),{id:"api_url",modelValue:o.value.api_url,"onUpdate:modelValue":e[5]||(e[5]=r=>o.value.api_url=r),placeholder:"https://api.example.com/context"},null,8,["modelValue"])])]),a("p",Ie,[e[25]||(e[25]=i(" Variables: ",-1)),a("code",Ve,p(S("phone_number")),1),e[26]||(e[26]=i(", ",-1)),a("code",$e,p(S("user_message")),1)]),a("div",Pe,[s(t(u),{for:"api_headers"},{default:l(()=>[...e[27]||(e[27]=[i("Headers (JSON, optional)",-1)])]),_:1}),s(t(O),{id:"api_headers",modelValue:o.value.api_headers,"onUpdate:modelValue":e[6]||(e[6]=r=>o.value.api_headers=r),placeholder:'{"Authorization": "Bearer xxx"}',rows:2},null,8,["modelValue"])]),a("div",Se,[s(t(u),{for:"api_response_path"},{default:l(()=>[...e[28]||(e[28]=[i("Response Path (optional)",-1)])]),_:1}),s(t(y),{id:"api_response_path",modelValue:o.value.api_response_path,"onUpdate:modelValue":e[7]||(e[7]=r=>o.value.api_response_path=r),placeholder:"data.context"},null,8,["modelValue"]),e[29]||(e[29]=a("p",{class:"text-xs text-muted-foreground"}," Dot-notation path to extract from JSON response. ",-1))])])):I("",!0),a("div",Te,[a("div",Ue,[s(t(u),{for:"priority"},{default:l(()=>[...e[32]||(e[32]=[i("Priority",-1)])]),_:1}),s(t(y),{id:"priority",modelValue:o.value.priority,"onUpdate:modelValue":e[8]||(e[8]=r=>o.value.priority=r),modelModifiers:{number:!0},type:"number",min:"1",max:"100"},null,8,["modelValue"]),e[33]||(e[33]=a("p",{class:"text-xs text-muted-foreground"},"Higher priority contexts are used first",-1))]),a("div",Ee,[V(a("input",{id:"enabled","onUpdate:modelValue":e[9]||(e[9]=r=>o.value.enabled=r),type:"checkbox",class:"h-4 w-4 rounded border-gray-300"},null,512),[[K,o.value.enabled]]),s(t(u),{for:"enabled"},{default:l(()=>[...e[34]||(e[34]=[i("Enabled",-1)])]),_:1})])])]),s(t(se),null,{default:l(()=>[s(t(f),{variant:"outline",onClick:e[10]||(e[10]=r=>_.value=!1)},{default:l(()=>[...e[35]||(e[35]=[i("Cancel",-1)])]),_:1}),s(t(f),{onClick:z,disabled:w.value},{default:l(()=>[i(p(c.value?"Update":"Create"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])]),s(t(X),{class:"flex-1"},{default:l(()=>[a("div",Ne,[(d(!0),g(N,null,F(b.value,r=>(d(),x(t(D),{key:r.id},{default:l(()=>[s(t(H),null,{default:l(()=>[a("div",Fe,[a("div",Le,[a("div",{class:q(["h-10 w-10 rounded-lg flex items-center justify-center",r.context_type==="api"?"bg-blue-100 dark:bg-blue-900":"bg-orange-100 dark:bg-orange-900"])},[r.context_type==="api"?(d(),x(t(pe),{key:0,class:"h-5 w-5 text-blue-600 dark:text-blue-400"})):(d(),x(t(de),{key:1,class:"h-5 w-5 text-orange-600 dark:text-orange-400"}))],2),a("div",null,[s(t(Q),{class:"text-base"},{default:l(()=>[i(p(r.name),1)]),_:2},1024),s(t(W),null,{default:l(()=>[i(p(r.context_type==="api"?"API Fetch":"Static Content"),1)]),_:2},1024)])]),s(t($),{variant:r.enabled?"default":"secondary"},{default:l(()=>[i(p(r.enabled?"Active":"Inactive"),1)]),_:2},1032,["variant"])])]),_:2},1024),s(t(L),null,{default:l(()=>{var U;return[(U=r.trigger_keywords)!=null&&U.length?(d(),g("div",De,[(d(!0),g(N,null,F(r.trigger_keywords,k=>(d(),x(t($),{key:k,variant:"outline",class:"text-xs"},{default:l(()=>[i(p(k),1)]),_:2},1024))),128))])):I("",!0),a("div",Oe,[s(t($),{variant:"secondary"},{default:l(()=>[i("Priority: "+p(r.priority),1)]),_:2},1024)]),a("div",Ge,[a("div",Me,[s(t(f),{variant:"ghost",size:"icon",onClick:k=>M(r)},{default:l(()=>[s(t(re),{class:"h-4 w-4"})]),_:1},8,["onClick"]),s(t(f),{variant:"ghost",size:"icon",onClick:k=>B(r)},{default:l(()=>[s(t(ne),{class:"h-4 w-4 text-destructive"})]),_:1},8,["onClick"])])])]}),_:2},1024)]),_:2},1024))),128)),b.value.length===0?(d(),x(t(D),{key:0,class:"col-span-full"},{default:l(()=>[s(t(L),{class:"py-12 text-center text-muted-foreground"},{default:l(()=>[s(t(ue),{class:"h-12 w-12 mx-auto mb-4 opacity-50"}),e[37]||(e[37]=a("p",{class:"text-lg font-medium"},"No AI contexts yet",-1)),e[38]||(e[38]=a("p",{class:"text-sm mb-4"},"Create knowledge contexts that the AI can use to answer questions.",-1)),s(t(f),{onClick:T},{default:l(()=>[s(t(G),{class:"h-4 w-4 mr-2"}),e[36]||(e[36]=i(" Create Context ",-1))]),_:1})]),_:1})]),_:1})):I("",!0)])]),_:1})])}}});export{lt as default};
