import{d as q,r as p,x as Q,Q as V,c as m,h as o,a as s,w as n,g as J,b as t,i as d,v as f,I as U,J as O,l as M,F as K,s as B,S as G,k as S,K as v,o as u}from"./index-CYNh7eqI.js";import{a as H,_ as W}from"./CardContent.vue_vue_type_script_setup_true_lang-BVSlREZs.js";import{_ as c}from"./Button.vue_vue_type_script_setup_true_lang-CdpToHaS.js";import{_ as k}from"./Input.vue_vue_type_script_setup_true_lang-c8YZDCZO.js";import{_ as x}from"./Label.vue_vue_type_script_setup_true_lang-BiSM-I6O.js";import{_ as X}from"./Textarea.vue_vue_type_script_setup_true_lang-qPA_yzOk.js";import{_ as A}from"./Badge.vue_vue_type_script_setup_true_lang-lXziiQoX.js";import{_ as Y}from"./ScrollArea.vue_vue_type_script_setup_true_lang-BYu-HJVo.js";import{_ as Z,a as ee,b as te,c as se,d as oe,e as ae}from"./DialogFooter.vue_vue_type_script_setup_true_lang-BYVwNXX_.js";import{_ as le}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-CvBIzWt_.js";import{S as ne}from"./search-C4qlZP-j.js";import{A as re}from"./arrow-left-DE60ug_1.js";import{P as D,T as L,a as de}from"./trash-2-ExN6Amm1.js";import{K as E}from"./key-DYPJDATy.js";import"./createLucideIcon-CJWRy_ZI.js";const ie={class:"flex flex-col h-full"},ue={class:"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"},pe={class:"flex h-16 items-center justify-between px-6"},ce={class:"flex items-center gap-4"},me={class:"space-y-4 py-4"},fe={class:"space-y-2"},ve={class:"space-y-2"},ye={class:"space-y-2"},_e={class:"space-y-2"},we={class:"flex items-center justify-between"},be={key:0,class:"space-y-2 mt-2"},xe={class:"space-y-2"},he={class:"flex items-center gap-2"},ke={class:"p-4 border-b"},ge={class:"relative max-w-md"},Ve={class:"p-6 space-y-4"},Ce={class:"flex items-start justify-between"},$e={class:"flex-1"},Ke={class:"flex items-center gap-2 mb-2"},Be={class:"flex flex-wrap gap-1"},Re={class:"text-sm text-muted-foreground mb-2"},Ue={class:"text-sm bg-muted p-2 rounded"},Me={class:"flex items-center gap-2 ml-4"},Se={key:0,class:"text-center py-12 text-muted-foreground"},He=q({__name:"KeywordsView",setup(Ae){const y=p([]),R=p(!0),_=p(!1),C=p(!1),g=p(""),w=p(null),l=p({keywords:"",match_type:"contains",response_type:"text",response_content:"",buttons:[],priority:0,enabled:!0});function N(){if(l.value.buttons.length>=10){v.error("Maximum 10 buttons allowed");return}l.value.buttons.push({id:"",title:""})}function P(r){l.value.buttons.splice(r,1)}Q(async()=>{await $()});async function $(){R.value=!0;try{const r=await V.listKeywords(),e=r.data.data||r.data;y.value=e.rules||[]}catch(r){console.error("Failed to load keyword rules:",r),y.value=[]}finally{R.value=!1}}function z(){w.value=null,l.value={keywords:"",match_type:"contains",response_type:"text",response_content:"",buttons:[],priority:0,enabled:!0},_.value=!0}function F(r){var e,b;w.value=r,l.value={keywords:r.keywords.join(", "),match_type:r.match_type,response_type:r.response_type,response_content:((e=r.response_content)==null?void 0:e.body)||"",buttons:((b=r.response_content)==null?void 0:b.buttons)||[],priority:r.priority,enabled:r.enabled},_.value=!0}async function T(){if(!l.value.keywords.trim()||!l.value.response_content.trim()){v.error("Please fill in all required fields");return}const r=l.value.buttons.filter(e=>e.id.trim()&&e.title.trim());C.value=!0;try{const e={keywords:l.value.keywords.split(",").map(b=>b.trim()).filter(Boolean),match_type:l.value.match_type,response_type:l.value.response_type,response_content:{body:l.value.response_content,buttons:r.length>0?r:void 0},priority:l.value.priority,enabled:l.value.enabled};w.value?(await V.updateKeyword(w.value.id,e),v.success("Keyword rule updated")):(await V.createKeyword(e),v.success("Keyword rule created")),_.value=!1,await $()}catch{v.error("Failed to save keyword rule")}finally{C.value=!1}}async function j(r){if(confirm("Are you sure you want to delete this keyword rule?"))try{await V.deleteKeyword(r.id),v.success("Keyword rule deleted"),await $()}catch{v.error("Failed to delete keyword rule")}}const I=p([]);return I.value=g.value?y.value.filter(r=>r.keywords.some(e=>e.toLowerCase().includes(g.value.toLowerCase()))):y.value,(r,e)=>{const b=J("RouterLink");return u(),m("div",ie,[o("header",ue,[o("div",pe,[o("div",ce,[s(b,{to:"/chatbot"},{default:n(()=>[s(t(c),{variant:"ghost",size:"icon"},{default:n(()=>[s(t(re),{class:"h-5 w-5"})]),_:1})]),_:1}),e[8]||(e[8]=o("div",null,[o("h1",{class:"text-xl font-semibold"},"Keyword Rules"),o("p",{class:"text-sm text-muted-foreground"},"Create automated responses for specific keywords")],-1))]),s(t(Z),{open:_.value,"onUpdate:open":e[6]||(e[6]=a=>_.value=a)},{default:n(()=>[s(t(le),{"as-child":""},{default:n(()=>[s(t(c),{onClick:z},{default:n(()=>[s(t(D),{class:"h-4 w-4 mr-2"}),e[9]||(e[9]=d(" Add Rule ",-1))]),_:1})]),_:1}),s(t(ee),{class:"max-w-md"},{default:n(()=>[s(t(te),null,{default:n(()=>[s(t(se),null,{default:n(()=>[d(f(w.value?"Edit":"Create")+" Keyword Rule",1)]),_:1}),s(t(oe),null,{default:n(()=>[...e[10]||(e[10]=[d(" Configure keywords that trigger automated responses. ",-1)])]),_:1})]),_:1}),o("div",me,[o("div",fe,[s(t(x),{for:"keywords"},{default:n(()=>[...e[11]||(e[11]=[d("Keywords (comma-separated)",-1)])]),_:1}),s(t(k),{id:"keywords",modelValue:l.value.keywords,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.keywords=a),placeholder:"hello, hi, hey"},null,8,["modelValue"])]),o("div",ve,[s(t(x),{for:"match_type"},{default:n(()=>[...e[12]||(e[12]=[d("Match Type",-1)])]),_:1}),U(o("select",{id:"match_type","onUpdate:modelValue":e[1]||(e[1]=a=>l.value.match_type=a),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},[...e[13]||(e[13]=[o("option",{value:"contains"},"Contains",-1),o("option",{value:"exact"},"Exact Match",-1),o("option",{value:"regex"},"Regex",-1)])],512),[[O,l.value.match_type]])]),o("div",ye,[s(t(x),{for:"response"},{default:n(()=>[...e[14]||(e[14]=[d("Response Message",-1)])]),_:1}),s(t(X),{id:"response",modelValue:l.value.response_content,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.response_content=a),placeholder:"Enter the response message...",rows:3},null,8,["modelValue"])]),o("div",_e,[o("div",we,[s(t(x),null,{default:n(()=>[...e[15]||(e[15]=[d("Buttons (optional, max 10)",-1)])]),_:1}),s(t(c),{type:"button",variant:"outline",size:"sm",onClick:N,disabled:l.value.buttons.length>=10},{default:n(()=>[s(t(D),{class:"h-3 w-3 mr-1"}),e[16]||(e[16]=d(" Add Button ",-1))]),_:1},8,["disabled"])]),e[17]||(e[17]=o("p",{class:"text-xs text-muted-foreground"}," Add buttons for quick replies. 3 or fewer shows as buttons, more than 3 shows as a list. ",-1)),l.value.buttons.length>0?(u(),m("div",be,[(u(!0),m(K,null,B(l.value.buttons,(a,h)=>(u(),m("div",{key:h,class:"flex items-center gap-2"},[s(t(k),{modelValue:a.id,"onUpdate:modelValue":i=>a.id=i,placeholder:"Button ID",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue"]),s(t(k),{modelValue:a.title,"onUpdate:modelValue":i=>a.title=i,placeholder:"Button Title",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue"]),s(t(c),{type:"button",variant:"ghost",size:"icon",onClick:i=>P(h)},{default:n(()=>[s(t(L),{class:"h-4 w-4 text-destructive"})]),_:1},8,["onClick"])]))),128))])):M("",!0)]),o("div",xe,[s(t(x),{for:"priority"},{default:n(()=>[...e[18]||(e[18]=[d("Priority (higher = checked first)",-1)])]),_:1}),s(t(k),{id:"priority",modelValue:l.value.priority,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.priority=a),modelModifiers:{number:!0},type:"number",min:"0"},null,8,["modelValue"])]),o("div",he,[U(o("input",{id:"enabled","onUpdate:modelValue":e[4]||(e[4]=a=>l.value.enabled=a),type:"checkbox",class:"h-4 w-4 rounded border-gray-300"},null,512),[[G,l.value.enabled]]),s(t(x),{for:"enabled"},{default:n(()=>[...e[19]||(e[19]=[d("Enabled",-1)])]),_:1})])]),s(t(ae),null,{default:n(()=>[s(t(c),{variant:"outline",onClick:e[5]||(e[5]=a=>_.value=!1)},{default:n(()=>[...e[20]||(e[20]=[d("Cancel",-1)])]),_:1}),s(t(c),{onClick:T,disabled:C.value},{default:n(()=>[d(f(w.value?"Update":"Create"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])]),o("div",ke,[o("div",ge,[s(t(ne),{class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s(t(k),{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=a=>g.value=a),placeholder:"Search keywords...",class:"pl-9"},null,8,["modelValue"])])]),s(t(Y),{class:"flex-1"},{default:n(()=>[o("div",Ve,[(u(!0),m(K,null,B(y.value,a=>(u(),S(t(W),{key:a.id},{default:n(()=>[s(t(H),{class:"p-4"},{default:n(()=>{var h;return[o("div",Ce,[o("div",$e,[o("div",Ke,[s(t(E),{class:"h-4 w-4 text-muted-foreground"}),o("div",Be,[(u(!0),m(K,null,B(a.keywords,i=>(u(),S(t(A),{key:i,variant:"secondary"},{default:n(()=>[d(f(i),1)]),_:2},1024))),128))]),s(t(A),{variant:a.enabled?"default":"outline"},{default:n(()=>[d(f(a.enabled?"Active":"Inactive"),1)]),_:2},1032,["variant"])]),o("p",Re," Match: "+f(a.match_type)+" | Priority: "+f(a.priority),1),o("p",Ue,f(((h=a.response_content)==null?void 0:h.body)||"No response configured"),1)]),o("div",Me,[s(t(c),{variant:"ghost",size:"icon",onClick:i=>F(a)},{default:n(()=>[s(t(de),{class:"h-4 w-4"})]),_:1},8,["onClick"]),s(t(c),{variant:"ghost",size:"icon",onClick:i=>j(a)},{default:n(()=>[s(t(L),{class:"h-4 w-4 text-destructive"})]),_:1},8,["onClick"])])])]}),_:2},1024)]),_:2},1024))),128)),y.value.length===0?(u(),m("div",Se,[s(t(E),{class:"h-12 w-12 mx-auto mb-4 opacity-50"}),e[21]||(e[21]=o("p",{class:"text-lg font-medium"},"No keyword rules yet",-1)),e[22]||(e[22]=o("p",{class:"text-sm"},"Create your first keyword rule to get started.",-1))])):M("",!0)])]),_:1})])}}});export{He as default};
